<script>
  (async function () {
    const params = new URLSearchParams(window.location.search);
    const token = params.get("token");
    const email = params.get("email");

    if (!token || !email) {
      document.body.innerHTML = "<h2>‚ùå Lien invalide</h2>";
      return;
    }

const res = await fetch(`https://script.google.com/macros/s/AKfycbzvxnysN3OOiqf2tbEbCAlb6b2fM1fI7KoLt7ML5rXELR4Fzt8AvZYDU-bfvBnS4to/exec?token=${token}&email=${encodeURIComponent(email)}`);
    const data = await res.json();

    if (data.valid) {
      document.body.innerHTML = "<h2>‚úÖ Bienvenue ! Voici votre guide :</h2><p><a href='/le-guide.pdf' target='_blank'>T√©l√©charger le guide</a></p>";
    } else if (data.reason === "expired_or_maxclicks") {
      document.body.innerHTML = "<h2>üïí Lien expir√© ou nombre de clics d√©pass√©</h2>";
    } else {
      document.body.innerHTML = "<h2>‚ùå Lien invalide</h2>";
    }
  })();
</script>
